// SPDX-License-Identifier: GPL-2.0
/*
 * Keystone 2 Kepler/Hawking EVM device tree
 *
 * Copyright (C) 2013-2017 Texas Instruments Incorporated - http://www.ti.com/
 */
/dts-v1/;

#include "keystone.dtsi"
#include "keystone-agib.dtsi"
#include <dt-bindings/net/ti-dp83867.h>
#include "agib-rapidio.dtsi"
#include "agib-bmuqt.dtsi"
#include "agib-lasc.dtsi"
#include "agib-tpm.dtsi"
#include "agib-rtc.dtsi"
#include "agib-reset.dtsi"
#include "agib-vgem.dtsi"

/ {
	compatible =  "ti,k2hk-evm", "ti,k2hk", "ti,keystone";
	model = "AB DS SLC AGIB board";

	reserved-memory {
		#address-cells = <2>;
		#size-cells = <2>;
		ranges;

		dsp_common_memory: dsp-common-memory@81f800000 {
			compatible = "shared-dma-pool";
			reg = <0x00000008 0x1f800000 0x00000000 0x800000>;
			reusable;
			status = "okay";
		};
	};

	leds {
		compatible = "gpio-leds";
		debug1_1 {
			label = "keystone:green:debug1";
			gpios = <&gpio0 12 GPIO_ACTIVE_HIGH>; /* 12 */
		};

		debug1_2 {
			label = "keystone:red:debug1";
			gpios = <&gpio0 13 GPIO_ACTIVE_HIGH>; /* 13 */
		};

		debug2 {
			label = "keystone:blue:debug2";
			gpios = <&gpio0 14 GPIO_ACTIVE_HIGH>; /* 14 */
		};

		debug3 {
			label = "keystone:blue:debug3";
			gpios = <&gpio0 15 GPIO_ACTIVE_HIGH>; /* 15 */
		};
	};
};

&soc0 {
		clocks {
			refclksys: refclksys {
				#clock-cells = <0>;
				compatible = "fixed-clock";
				clock-frequency = <122880000>;
				clock-output-names = "refclk-sys";
			};

			refclkpass: refclkpass {
				#clock-cells = <0>;
				compatible = "fixed-clock";
				clock-frequency = <122880000>;
				clock-output-names = "refclk-pass";
			};

			refclkarm: refclkarm {
				#clock-cells = <0>;
				compatible = "fixed-clock";
				clock-frequency = <125000000>;
				clock-output-names = "refclk-arm";
			};

			refclkddr3a: refclkddr3a {
				#clock-cells = <0>;
				compatible = "fixed-clock";
				clock-frequency = <100000000>;
				clock-output-names = "refclk-ddr3a";
			};

			refclkddr3b: refclkddr3b {
				#clock-cells = <0>;
				compatible = "fixed-clock";
				clock-frequency = <100000000>;
				clock-output-names = "refclk-ddr3b";
			};
		};
};

/omit-if-no-ref/ &clkgem0;

&usb_phy {
	status = "okay";
};

&keystone_usb0 {
	status = "okay";
};

&usb0 {
	dr_mode = "host";
};

&aemif {
	cs0 {
		#address-cells = <2>;
		#size-cells = <1>;
		clock-ranges;
		ranges;

		ti,cs-chipselect = <0>;
		/* all timings in nanoseconds */
		ti,cs-min-turnaround-ns = <12>;
		ti,cs-read-hold-ns = <6>;
		ti,cs-read-strobe-ns = <23>;
		ti,cs-read-setup-ns = <9>;
		ti,cs-write-hold-ns = <8>;
		ti,cs-write-strobe-ns = <23>;
		ti,cs-write-setup-ns = <8>;

		nand@0,0 {
			compatible = "ti,keystone-nand","ti,davinci-nand";
			#address-cells = <1>;
			#size-cells = <1>;
			reg = <0 0 0x4000000 //	EMIF16 CE0 space is at	offset 0x0 and has a length of 0x4000000
			       1 0 0x0000100>;

			ti,davinci-chipselect = <0>;
			ti,davinci-mask-ale = <0x2000>;
			ti,davinci-mask-cle = <0x4000>;
			ti,davinci-mask-chipsel = <0>;
			nand-ecc-mode = "hw";
			ti,davinci-ecc-bits = <4>;
			nand-on-flash-bbt;

			partition@0 {
				label = "golden u-boot environment";
				reg = <0x0 0x40000>; // One erase sector : 256KB
				read-only;
			};

			partition@1 {
				label = "default u-boot environment";
				reg = <0x00040000 0x00040000>; // One erase sector : 256KB
			};

			partition@2 {
				label = "temporary files";
				reg = <0x00080000 0x0C800000>; // 200MB
			};

			partition@3 {
				label = "run-time files";
				reg = <0x0C880000 0x12c00000>; // 300MB
			};

			partition@4 {
				label = "run-time files and logs";
				reg = <0x1f480000 0x20b80000>; // 1GB - 300MB - 200MB - 512KB
			};
		};
	};

	cs1 {
		#address-cells = <2>;
		#size-cells = <1>;
		clock-ranges;
		ranges;

		ti,cs-chipselect = <1>;
		/* all timings in nanoseconds */
		ti,cs-min-turnaround-ns = <12>;
		ti,cs-read-hold-ns = <6>;
		ti,cs-read-strobe-ns = <23>;
		ti,cs-read-setup-ns = <9>;
		ti,cs-write-hold-ns = <8>;
		ti,cs-write-strobe-ns = <23>;
		ti,cs-write-setup-ns = <8>;

		nand@1,1 {
			compatible = "ti,keystone-nand","ti,davinci-nand";
			#address-cells = <1>;
			#size-cells = <1>;
			reg = <0 0x4000000 0x4000000 // EMIF16 CE1 space is at offset 0x4000000 and has a length of 0x4000000
			       1 0 0x0000100>;

			ti,davinci-chipselect = <1>;
			ti,davinci-mask-ale = <0x2000>;
			ti,davinci-mask-cle = <0x4000>;
			ti,davinci-mask-chipsel = <0>;
			nand-ecc-mode = "hw";
			ti,davinci-ecc-bits = <4>;
			nand-on-flash-bbt;

			partition@0 {
				label = "save core dumps and kernel dumps";
				reg = <0x0 0x40000000>; // The whole chip 1GB
			};
		};
	};
};

&i2c0 {
	dtt@50 {
		compatible = "atmel,24c1024";
		reg = <0x50>;
	};
};

&spi0 {
	nor_flash: is25wp128@0 {
		#address-cells = <1>;
		#size-cells = <1>;
		compatible = "issi,is25wp128", "jedec,spi-nor";
		spi-max-frequency = <13000000>;
		m25p,fast-read;
		reg = <0>;

		partition@0 {
			label = "dsp-boot-program";
			reg = <0x0 0x800000>;
			read-only;
		};

		partition@1 {
			label = "u-boot-image";
			reg = <0x800000 0x600000>;
		};

		partition@2 {
			label = "boot certs";
			reg = <0xe00000 0x100000>;
		};

		partition@3 {
			label = "crtm creds";
			reg = <0xf00000 0x100000>;
		};
	};
};

&mdio {
	status = "ok";
	ethphy0: ethernet-phy@0 {
		compatible = "marvell,88E1111", "ethernet-phy-ieee802.3-c22";
		ti,fifo-depth = <DP83867_PHYCR_FIFO_DEPTH_8_B_NIB>;
		reg = <0>;
	};

//	ethphy1: ethernet-phy@1 {
//		compatible = "marvell,88E1111", "ethernet-phy-ieee802.3-c22";
//		ti,fifo-depth = <DP83867_PHYCR_FIFO_DEPTH_8_B_NIB>;
//		reg = <1>;
//	};
};

&netcp {
       netcp-interfaces {
               interface-0 {
                       efuse-mac = <0>;
                       local-mac-address = [00 00 00 00 00 00];
               };
       };
};
